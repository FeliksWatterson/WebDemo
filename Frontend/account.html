<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tài khoản của tôi - EduWeb</title>

    <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="./assets/css/style.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        background: var(--cultured);
      }
      .wrap {
        max-width: 1200px;
        margin: 0 auto;
      }
      .page-head {
        padding: 6px 4px;
      }
      .page-head .h2 {
        font-size: 30px;
        line-height: 1.2;
        font-weight: 800;
      }

      .grid-2 {
        display: grid;
        grid-template-columns: 280px 1fr;
        gap: 24px;
        align-items: stretch;
      }
      .card {
        background: #fff;
        border: 1px solid var(--platinum);
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.04);
        height: 100%;
      }

      .left {
        padding: 18px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .left ul {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .left a {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px;
        border-radius: 12px;
        color: var(--eerie-black-1);
      }
      .left a:hover {
        background: var(--cultured);
      }
      .left .vip {
        color: var(--radical-red);
      }

      .right .panel {
        padding: 22px;
      }

      .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px 16px;
        align-items: end;
      }
      .span-2 {
        grid-column: 1 / -1;
      }

      .avatar-row {
        grid-column: 1 / -1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        margin: 4px 0 8px;
      }
      .avatar {
        position: relative;
        width: 132px;
        height: 132px;
        border-radius: 999px;
        border: 2px solid var(--platinum);
        overflow: hidden;
        background: #fff;
      }
      .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .avatar-edit {
        position: absolute;
        right: -6px;
        bottom: -6px;
        width: 38px;
        height: 38px;
        border-radius: 999px;
        background: var(--yale-blue);
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #fff;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        cursor: pointer;
      }
      #avatar-file {
        display: none;
      }
      .hint {
        opacity: 0.7;
        font-size: 0.92rem;
      }

      .field {
        display: grid;
        gap: 6px;
      }
      .field label {
        font-weight: 700;
      }
      .ipt,
      .txt {
        width: 100%;
        background: #fff;
        border: 1px solid var(--platinum);
        border-radius: 10px;
        height: 46px;
        padding: 10px 12px;
      }
      .txt {
        height: auto;
      }

      .gender {
        display: flex;
        gap: 22px;
        align-items: center;
        height: 46px;
        border: 1px solid var(--platinum);
        border-radius: 10px;
        padding: 0 12px;
        background: #fff;
      }
      .gender label {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
      }

      .actions {
        display: flex;
        justify-content: flex-end;
        margin-top: 8px;
      }
      .btn-save {
        background: #c9d4fb;
        color: #2b2f42;
        border: 0;
        border-radius: 12px;
        padding: 10px 22px;
        font-weight: 700;
      }

      @media (max-width: 992px) {
        .grid-2 {
          grid-template-columns: 1fr;
        }
        .form-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body id="top">
    <header class="header" data-header>
      <div class="container">
        <a href="#" class="logo"
          ><img
            src="./assets/images/logo.svg"
            width="162"
            height="50"
            alt="EduWeb logo"
        /></a>
        <nav class="navbar" data-navbar>
          <div class="wrapper">
            <a href="#" class="logo"
              ><img
                src="./assets/images/logo.svg"
                width="162"
                height="50"
                alt="EduWeb logo"
            /></a>
            <button
              class="nav-close-btn"
              aria-label="close menu"
              data-nav-toggler
            >
              <ion-icon name="close-outline" aria-hidden="true"></ion-icon>
            </button>
          </div>
          <ul class="navbar-list">
            <li class="navbar-item">
              <a href="index.html" class="navbar-link" data-nav-link
                >Trang chủ</a
              >
            </li>
            <li class="navbar-item has-dropdown">
              <a
                href="./luyende.html"
                class="navbar-link"
                data-nav-link
                aria-haspopup="true"
                aria-expanded="false"
              >
                Luyện tập
                <ion-icon
                  name="chevron-down-outline"
                  class="dropdown-arrow"
                  aria-hidden="true"
                ></ion-icon>
              </a>
              <ul class="dropdown-menu" role="menu">
                <li class="dropdown-item" role="none">
                  <a href="./taode.html" class="dropdown-link" role="menuitem"
                    >Tạo đề thông minh</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a href="./tuvung.html" class="dropdown-link" role="menuitem"
                    >Học từ vựng</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a
                    href="./luyende.html?subject=ielts"
                    class="dropdown-link"
                    role="menuitem"
                    >Thi thử</a
                  >
                </li>
              </ul>
            </li>
            <li class="navbar-item has-dropdown">
              <a
                href=""
                class="navbar-link"
                data-nav-link
                aria-haspopup="true"
                aria-expanded="false"
              >
                Góc học tập
                <ion-icon
                  name="chevron-down-outline"
                  class="dropdown-arrow"
                  aria-hidden="true"
                ></ion-icon>
              </a>
              <ul class="dropdown-menu" role="menu">
                <li class="dropdown-item" role="none">
                  <a href="class.html" class="dropdown-link" role="menuitem"
                    >Lớp học</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a href="" class="dropdown-link" role="menuitem">Tổng quan</a>
                </li>
                <li class="dropdown-item" role="none">
                  <a href="" class="dropdown-link" role="menuitem"
                    >Kế hoạch học tập</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a href="" class="dropdown-link" role="menuitem"
                    >Phân tích & tiến độ</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a href="" class="dropdown-link" role="menuitem"
                    >Thành tích học tập</a
                  >
                </li>
              </ul>
            </li>
            <li class="navbar-item has-dropdown">
              <a
                href="./blog.html"
                class="navbar-link"
                data-nav-link
                aria-haspopup="true"
                aria-expanded="false"
              >
                Cộng đồng
                <ion-icon
                  name="chevron-down-outline"
                  class="dropdown-arrow"
                  aria-hidden="true"
                ></ion-icon>
              </a>
              <ul class="dropdown-menu" role="menu">
                <li class="dropdown-item" role="none">
                  <a href="./blog.html" class="dropdown-link" role="menuitem"
                    >Diễn đàn</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a
                    href="./phonghoc.html"
                    class="dropdown-link"
                    role="menuitem"
                    >Học nhóm</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a
                    href="./phonghoc.html"
                    class="dropdown-link"
                    role="menuitem"
                    >Tìm bạn học ngay</a
                  >
                </li>
                <li class="dropdown-item" role="none">
                  <a href="./bxh.html" class="dropdown-link" role="menuitem"
                    >Bảng xếp hạng thành tích học tập
                    <p></p
                  ></a>
                </li>
              </ul>
            </li>
            <li class="navbar-item">
              <a href="troly.html" class="navbar-link" data-nav-link
                >Trợ lý AI</a
              >
            </li>
            <ul class="navbar-list">
              <li class="navbar-item">
                <a href="index.html" class="navbar-link" data-nav-link
                  >Nâng cấp</a
                >
              </li>
            </ul>
          </ul>
        </nav>
        <div class="header-actions">
          <button
            class="header-action-btn"
            aria-label="toggle search"
            title="Search"
          >
            <ion-icon name="search-outline" aria-hidden="true"></ion-icon>
          </button>
          <a href="./auth.html" class="btn has-before"
            ><span class="span">Bắt đầu ngay</span
            ><ion-icon
              name="arrow-forward-outline"
              aria-hidden="true"
            ></ion-icon
          ></a>
          <button
            class="header-action-btn"
            aria-label="open menu"
            data-nav-toggler
          >
            <ion-icon name="menu-outline" aria-hidden="true"></ion-icon>
          </button>
        </div>
        <div class="overlay" data-nav-toggler data-overlay></div>
      </div>
    </header>

    <main>
      <article>
        <section
          class="section"
          style="
            padding-top: calc(var(--section-padding) + 60px);
            padding-bottom: var(--section-padding);
          "
        >
          <div class="settings-layout container">
            <aside class="settings-sidebar card">
              <nav>
                <ul>
                  <li class="active">
                    <a href="#" data-tab="general" aria-current="page">Chung</a>
                  </li>
                  <li>
                    <a href="#" data-tab="password" id="nav-password"
                      >Đổi mật khẩu</a
                    >
                  </li>
                  <li><a href="#" data-tab="org" id="nav-org">Đơn vị</a></li>
                  <li><a href="#" data-tab="vip" class="vip">Azota VIP</a></li>
                </ul>
              </nav>
              <div class="sidebar-actions">
                <button id="logout-btn" class="btn danger full">
                  Đăng xuất
                </button>
              </div>
            </aside>

            <section class="settings-content">
              <header class="settings-header">
                <h2 class="h2">Cài đặt tài khoản</h2>
              </header>

              <!-- Tab: Chung -->
              <div class="tab-panel is-active" id="tab-general">
                <div class="settings-card card">
                  <div class="settings-grid">
                    <!-- Avatar -->
                    <div class="avatar-block">
                      <div class="avatar">
                        <img
                          id="avatar-preview"
                          src="./assets/images/avatar-placeholder.png"
                          alt="Avatar"
                        />
                      </div>
                      <label class="btn outline" for="avatar-file"
                        >Tải lên</label
                      >
                      <input
                        id="avatar-file"
                        type="file"
                        accept="image/*"
                        hidden
                      />
                      <p class="muted">Tải lên file ảnh &le; 5MB</p>
                    </div>

                    <!-- Form -->
                    <form class="form-block" onsubmit="return false;">
                      <div class="form-row">
                        <label for="display-name">Họ và tên</label>
                        <input
                          id="display-name"
                          type="text"
                          placeholder="Nhập họ và tên"
                        />
                      </div>

                      <div class="form-row">
                        <label for="username">Username</label>
                        <input
                          id="username"
                          type="text"
                          placeholder="Đặt username (tùy chọn)"
                        />
                      </div>

                      <div class="form-row">
                        <label for="acc-email">Email</label>
                        <div class="input-with-note">
                          <input id="acc-email" type="email" readonly />
                          <a class="note-link" href="#" title="Đổi email"
                            >Click vào đây để đổi email</a
                          >
                        </div>
                      </div>

                      <div class="two-col">
                        <div class="form-row">
                          <label for="dob">Ngày sinh</label>
                          <input id="dob" type="date" placeholder="Ngày sinh" />
                        </div>
                        <div class="form-row">
                          <label for="phone">Số điện thoại</label>
                          <input
                            id="phone"
                            type="tel"
                            placeholder="Nhập số điện thoại"
                          />
                        </div>
                      </div>

                      <div class="form-row">
                        <label>Giới tính</label>
                        <div class="radio-group">
                          <label
                            ><input type="radio" name="gender" value="male" />
                            Nam</label
                          >
                          <label
                            ><input type="radio" name="gender" value="female" />
                            Nữ</label
                          >
                        </div>
                      </div>

                      <div class="form-row">
                        <label for="parent-phone"
                          >Số điện thoại phụ huynh</label
                        >
                        <div class="input-with-note">
                          <input
                            id="parent-phone"
                            type="tel"
                            placeholder="(tùy chọn)"
                          />
                          <button
                            class="linklike"
                            type="button"
                            id="add-parent"
                          >
                            + Thêm phụ huynh
                          </button>
                        </div>
                      </div>

                      <div class="form-row">
                        <label for="school">Thông tin trường</label>
                        <textarea
                          id="school"
                          rows="3"
                          placeholder="Tên trường, lớp, mã số học sinh…"
                        ></textarea>
                      </div>

                      <div class="hidden">
                        <input id="acc-id" type="text" readonly />
                      </div>
                    </form>
                  </div>
                </div>

                <footer class="settings-actions">
                  <button id="save-profile" class="btn has-before">
                    <span class="span">Cập nhật</span>
                  </button>
                </footer>
              </div>

              <!-- Tab: Đổi mật khẩu -->
              <div class="tab-panel" id="tab-password">
                <div class="settings-card card">
                  <form class="form-block" onsubmit="return false;">
                    <div class="form-row">
                      <label for="cur-pass">Mật khẩu hiện tại</label>
                      <input
                        id="cur-pass"
                        type="password"
                        placeholder="Nhập mật khẩu hiện tại"
                      />
                    </div>
                    <div class="form-row">
                      <label for="new-pass">Mật khẩu mới</label>
                      <input
                        id="new-pass"
                        type="password"
                        placeholder="Nhập mật khẩu mới"
                      />
                    </div>
                    <div class="form-row">
                      <label for="re-pass">Nhập lại mật khẩu</label>
                      <input
                        id="re-pass"
                        type="password"
                        placeholder="Nhập lại mật khẩu mới"
                      />
                    </div>
                  </form>
                </div>
                <footer class="settings-actions">
                  <button class="btn has-before" id="save-pass">
                    <span class="span">Đổi mật khẩu</span>
                  </button>
                </footer>
              </div>

              <!-- Tab: Đơn vị -->
              <div class="tab-panel" id="tab-org">
                <div class="settings-card card">
                  <p class="muted">Tính năng quản lý đơn vị sẽ cập nhật sau.</p>
                </div>
              </div>

              <!-- Tab: VIP -->
              <div class="tab-panel" id="tab-vip">
                <div class="settings-card card">
                  <p class="muted">Azota VIP – sắp ra mắt 🎁</p>
                </div>
              </div>
            </section>
          </div>
        </section>
      </article>
    </main>

    <footer
      class="footer"
      style="background-image: url('./assets/images/footer-bg.png')"
    >
      <div class="footer-top section">
        <div class="container grid-list">
          <div class="footer-brand">
            <a href="./index.html" class="logo"
              ><img
                src="./assets/images/logo-light.svg"
                width="162"
                height="50"
                alt="EduWeb logo"
            /></a>
            <p class="footer-brand-text">
              Nền tảng học tập trực tuyến hàng đầu, đồng hành cùng bạn trên con
              đường chinh phục tri thức.
            </p>
            <div class="wrapper">
              <span class="span">Địa chỉ:</span>
              <address class="address">Hà Đông, Hà Nội, Việt Nam</address>
            </div>
            <div class="wrapper">
              <span class="span">Điện thoại:</span
              ><a href="tel:+84123456789" class="footer-link"
                >+84 123 456 789</a
              >
            </div>
            <div class="wrapper">
              <span class="span">Email:</span
              ><a href="mailto:info@eduweb.com" class="footer-link"
                >info@eduweb.com</a
              >
            </div>
          </div>
          <ul class="footer-list">
            <li><p class="footer-list-title">Nền tảng</p></li>
            <li>
              <a href="./index.html#about" class="footer-link">Về EduWeb</a>
            </li>
            <li><a href="./luyende.html" class="footer-link">Luyện đề</a></li>
            <li><a href="./thithu.html" class="footer-link">Thi thử</a></li>
            <li><a href="./blog.html" class="footer-link">Diễn đàn</a></li>
          </ul>
          <ul class="footer-list">
            <li><p class="footer-list-title">Liên kết nhanh</p></li>
            <li><a href="#" class="footer-link">Liên hệ</a></li>
            <li><a href="#" class="footer-link">Điều khoản dịch vụ</a></li>
            <li><a href="#" class="footer-link">Chính sách bảo mật</a></li>
            <li><a href="#" class="footer-link">Câu hỏi thường gặp</a></li>
          </ul>
          <div class="footer-list">
            <p class="footer-list-title">Đăng ký nhận tin</p>
            <p class="footer-list-text">
              Nhận thông tin mới nhất về các khóa học và ưu đãi.
            </p>
            <form action="" class="newsletter-form">
              <input
                type="email"
                name="email_address"
                placeholder="Email của bạn"
                required
                class="input-field"
              />
              <button type="submit" class="btn has-before">
                <span class="span">Đăng ký</span
                ><ion-icon
                  name="arrow-forward-outline"
                  aria-hidden="true"
                ></ion-icon>
              </button>
            </form>
            <ul class="social-list">
              <li>
                <a href="#" class="social-link"
                  ><ion-icon name="logo-facebook"></ion-icon
                ></a>
              </li>
              <li>
                <a href="#" class="social-link"
                  ><ion-icon name="logo-youtube"></ion-icon
                ></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="container">
          <p class="copyright">
            Bản quyền © 2025 EduWeb bởi
            <a href="#" class="copyright-link">lehoangducmanh</a>. Đã đăng ký
            bản quyền.
          </p>
        </div>
      </div>
    </footer>

    <script src="./assets/js/script.js" defer></script>
    <script src="./assets/js/auth.js" defer></script>
    <script
      type="module"
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
    ></script>

    <script>
      (() => {
        const token = localStorage.getItem("token");
        if (!token) {
          location.href = "./auth.html#login";
          return;
        }
        function headers() {
          return {
            "Content-Type": "application/json",
            Authorization: "Bearer " + token,
          };
        }
        fetch("/api/me", { headers: headers() })
          .then((r) => (r.ok ? r.json() : Promise.reject()))
          .then((data) => {
            const emailEl = document.getElementById("acc-email");
            if (emailEl) emailEl.value = data?.email || "";
            const idEl = document.getElementById("acc-id");
            if (idEl) idEl.value = data?.id || "";
            const nameEl = document.getElementById("display-name");
            if (nameEl && !nameEl.value && data?.email)
              nameEl.value = data.email.split("@")[0];
          })
          .catch(() => {
            localStorage.removeItem("token");
            location.href = "./auth.html#login";
          });

        const file = document.getElementById("avatar-file");
        const editBtn = document.getElementById("avatar-edit");
        editBtn?.addEventListener("click", () => file?.click());
        file?.addEventListener("change", (e) => {
          const f = e.target.files?.[0];
          if (!f) return;
          if (f.size > 5 * 1024 * 1024) {
            alert("Ảnh lớn hơn 5MB");
            return;
          }
          const url = URL.createObjectURL(f);
          document.getElementById("avatar-preview").src = url;
        });

        document
          .getElementById("save-profile")
          ?.addEventListener("click", () => {
            alert("Cập nhật hồ sơ sẽ được bổ sung backend sau.");
          });
      })();
    </script>
    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        const token = localStorage.getItem("token");
        if (!token) {
          location.href = "./auth.html#login";
          return;
        }

        fetch("/api/me", { headers: { Authorization: "Bearer " + token } })
          .then((r) => (r.ok ? r.json() : Promise.reject()))
          .then((me) => {
            const emailEl = document.getElementById("acc-email");
            const idEl = document.getElementById("acc-id");
            if (emailEl) emailEl.value = me.email || "";
            if (idEl) idEl.value = me.id || "";
            if (!document.getElementById("display-name").value && me?.email) {
              document.getElementById("display-name").value =
                me.email.split("@")[0];
            }
          })
          .catch(() => {
            localStorage.removeItem("token");
            location.href = "./auth.html#login";
          });

        document
          .querySelectorAll(".settings-sidebar a[data-tab]")
          .forEach((a) => {
            a.addEventListener("click", (e) => {
              e.preventDefault();
              document
                .querySelectorAll(".settings-sidebar li")
                .forEach((li) => li.classList.remove("active"));
              a.parentElement.classList.add("active");
              const tab = a.dataset.tab;
              document
                .querySelectorAll(".tab-panel")
                .forEach((p) => p.classList.remove("is-active"));
              document.getElementById("tab-" + tab)?.classList.add("is-active");
            });
          });

        document.getElementById("logout-btn")?.addEventListener("click", () => {
          localStorage.removeItem("token");
          location.href = "/";
        });

        const file = document.getElementById("avatar-file");
        file?.addEventListener("change", (e) => {
          const f = e.target.files?.[0];
          if (!f) return;
          if (f.size > 5 * 1024 * 1024) {
            alert("Ảnh lớn hơn 5MB");
            return;
          }
          const url = URL.createObjectURL(f);
          document.getElementById("avatar-preview").src = url;
        });

        document
          .getElementById("save-profile")
          ?.addEventListener("click", () => {
            alert("Cập nhật hồ sơ sẽ bổ sung backend sau.");
          });

        document.getElementById("save-pass")?.addEventListener("click", () => {
          alert("Đổi mật khẩu sẽ bổ sung backend sau.");
        });
      });
    </script>
  </body>
</html>
